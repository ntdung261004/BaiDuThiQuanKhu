{% extends "base.html" %}

{% block title %}Livestream{% endblock %}

{% block content %}
<div class="d-flex" id="wrapper">
    {% include 'sidebar.html' %}
    <div id="page-content-wrapper" style="width: 85%;">
        <nav class="navbar navbar-expand-lg navbar-light bg-light py-4 px-4">
            <h2 class="fs-2 m-0">
                Livestream
                <span id="soldier-info" class="text-muted fs-4 ms-2 d-none"></span>
                <button id="clear-soldier-btn" class="btn btn-sm btn-link text-danger p-0" style="vertical-align: super; display: none;">
                    <i class="fas fa-times-circle"></i>
                </button>
            </h2>
            <button class="btn btn-primary ms-auto" data-bs-toggle="modal" data-bs-target="#modeSelectionModal">
                <i class="fas fa-bullseye me-2"></i> Chọn Chế độ
            </button>
        </nav>

        <div class="container-fluid px-4 mt-4">
            <div id="main-content-area">
                {% include 'partials/free_mode.html' %}
            </div>
        </div>
    </div>
</div>

{% include 'partials/mode_selection_modal.html' %}

{% endblock %}

{% block scripts %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/stream.css') }}">

<script>
    window.API_ENDPOINTS = {
        soldier_count: "{{ url_for('soldier_bp.get_soldier_count') }}",
        get_soldier_base: "{{ url_for('soldier_bp.get_soldier', soldier_id=0) }}"
    };

    // Lấy soldier_id từ URL
    const urlParams = new URLSearchParams(window.location.search);
    const soldierId = urlParams.get('soldier_id');
    if (soldierId) {
        window.currentSoldierId = soldierId;
    }
</script>

<script src="{{ url_for('static', filename='js/stream.js') }}"></script>
{% endblock %}